/* =========================================
   INSIGHT GAPS - MASTER DESIGN SYSTEM
   ========================================= */

:root {
  /* Colors */
  --bg-primary: #ffffff;
  --bg-secondary: #f8f9fa;
  --bg-tertiary: #f4f6f8;
  --text-primary: #111111;
  --text-secondary: #555555;
  --text-meta: #767676;
  --accent: #004d40; /* Deep Teal */
  --accent-hover: #00695c;
  --border: #e0e0e0;
  --border-light: #f0f0f0;
  --error: #b71c1c;

  /* Typography */
  --font-serif: 'Charter', 'Bitstream Charter', serif;
  --font-sans: system-ui, -apple-system, sans-serif;

  /* Layout */
  --container-width: 1100px;
  --container-width-narrow: 800px;
  --header-height: 80px;
  --border-radius: 4px;
}

/* --- RESET & BASE --- */
* { box-sizing: border-box; margin: 0; padding: 0; }
body { font-family: var(--font-serif); color: var(--text-primary); background: var(--bg-primary); line-height: 1.6; }
img { max-width: 100%; display: block; }
a { color: var(--accent); text-decoration: none; transition: 0.2s ease; }
a:hover { color: var(--accent-hover); }

/* --- TYPOGRAPHY --- */
h1, h2, h3, h4 { font-family: var(--font-sans); font-weight: 700; color: var(--text-primary); line-height: 1.1; }
h1 { font-size: 2.5rem; margin-bottom: 24px; }
h2 { font-size: 2rem; margin: 48px 0 24px; }
h3 { font-size: 1.5rem; margin: 32px 0 16px; }
p { margin-bottom: 24px; color: var(--text-secondary); }

/* Forensic Intro Block */
.forensic-intro {
  font-size: 1.25rem;
  color: var(--text-primary);
  margin: 40px 0;
  border-left: 4px solid var(--accent);
  padding-left: 24px;
  font-style: italic;
  background: var(--bg-secondary);
  padding: 24px;
  border-radius: 0 4px 4px 0;
}

/* --- LAYOUT --- */
.page-container { max-width: var(--container-width); margin: 60px auto; padding: 0 24px; }
.container-narrow { max-width: var(--container-width-narrow); margin: 0 auto; }

/* --- HEADER & NAV --- */
.site-header { border-bottom: 1px solid var(--border); background: var(--bg-primary); position: sticky; top: 0; z-index: 1000; }
.header-inner { max-width: var(--container-width); margin: 0 auto; height: var(--header-height); display: flex; justify-content: space-between; align-items: center; padding: 0 24px; }
.main-nav { display: flex; gap: 32px; height: 100%; align-items: center; }
.nav-link { font-family: var(--font-sans); font-weight: 700; text-transform: uppercase; font-size: 0.85rem; color: var(--text-primary); padding: 28px 0; position: relative; }
.nav-link:hover, .nav-link.active { color: var(--accent); }
.nav-link.active::after { content: ''; position: absolute; bottom: 0; left: 0; width: 100%; height: 3px; background: var(--accent); }

/* Mega Menu */
.mega-menu-container {
  position: absolute; top: 100%; right: 0; width: 900px;
  background: var(--bg-primary); border: 1px solid var(--border);
  box-shadow: 0 15px 30px rgba(0,0,0,0.1); display: flex;
  opacity: 0; visibility: hidden; transform: translateY(10px); transition: 0.2s ease;
}
.nav-item:hover .mega-menu-container { opacity: 1; visibility: visible; transform: translateY(0); }

.mega-sidebar { width: 240px; background: var(--bg-secondary); border-right: 1px solid var(--border); }
.mega-sidebar-link { display: block; padding: 16px 24px; font-family: var(--font-sans); font-weight: 600; color: var(--text-secondary); border-bottom: 1px solid var(--border-light); }
.mega-sidebar-link:hover, .mega-sidebar-link.active { background: var(--accent); color: white; }

.mega-content { flex: 1; padding: 32px; }
.mega-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 24px; }
.mega-grid-link { font-family: var(--font-sans); font-size: 0.85rem; color: var(--text-secondary); border-bottom: 1px dotted #ccc; padding-bottom: 8px; }
.mega-grid-link:hover { color: var(--accent); border-color: var(--accent); }

/* --- FORENSIC CARDS (Analysis Index) --- */
.forensic-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 32px; margin-top: 40px; }
.forensic-card {
  background: white; border: 1px solid var(--border); border-left: 6px solid var(--text-primary);
  border-radius: 6px; overflow: hidden; display: flex; flex-direction: column;
  transition: transform 0.2s, box-shadow 0.2s;
}
.forensic-card:hover { transform: translateY(-5px); box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
.card-financial { border-left-color: #0ea5e9; }
.card-leakage { border-left-color: #8b5cf6; }
.card-workorder { border-left-color: #f97316; }

.card-preview-stage { height: 160px; background: var(--bg-tertiary); position: relative; overflow: hidden; cursor: pointer; }
.card-preview-img { width: 100%; height: 100%; object-fit: cover; transition: 0.5s; }
.forensic-card:hover .card-preview-img { transform: scale(1.05); opacity: 0.9; }

.card-content { padding: 24px; display: flex; flex-direction: column; flex-grow: 1; }
.tagline { font-family: var(--font-sans); font-size: 0.7rem; font-weight: 800; text-transform: uppercase; color: var(--accent); margin-bottom: 8px; display: block; }
.btn-report { font-family: var(--font-sans); font-weight: 700; border-bottom: 2px solid var(--accent); display: inline-block; margin-top: auto; }

/* --- POPUP SYSTEM --- */
.popup-overlay {
  position: fixed; top: 0; left: 0; width: 100%; height: 100%;
  background: rgba(0,0,0,0.9); z-index: 9999;
  display: flex; justify-content: center; align-items: center;
  opacity: 0; visibility: hidden; transition: 0.3s;
}
.popup-overlay.active { opacity: 1; visibility: visible; }
.popup-content { position: relative; max-width: 90%; max-height: 90%; }
.popup-image { max-width: 100%; max-height: 90vh; border-radius: 4px; box-shadow: 0 0 50px rgba(0,0,0,0.5); }
.popup-close { position: absolute; top: -40px; right: 0; color: white; font-size: 2rem; background: none; border: none; cursor: pointer; }
.popup-caption { color: white; text-align: center; margin-top: 10px; font-family: var(--font-sans); }

/* --- REPORT UTILITIES --- */
.back-link { font-family: var(--font-sans); font-size: 0.9rem; margin-bottom: 24px; display: inline-block; }
.report-subnav { display: flex; gap: 20px; margin-bottom: 40px; border-bottom: 1px solid var(--border); padding-bottom: 10px; }
.subnav-link { font-family: var(--font-sans); font-size: 0.9rem; color: var(--text-meta); }
.subnav-link.active { color: var(--accent); font-weight: 700; border-bottom: 2px solid var(--accent); }

/* --- FOOTER --- */
.site-footer { border-top: 1px solid var(--border); padding: 48px 0; margin-top: 80px; text-align: center; font-family: var(--font-sans); font-size: 0.85rem; color: var(--text-meta); }
.footer-nav a { margin: 0 12px; color: var(--text-secondary); }
